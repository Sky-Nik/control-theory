% OK, incomplete, missing 2.7, 2.8

\subsection*{Домашнє завдання}

% \begin{problem*}
%     $A = \{-5, -3, 2\}$, $B = \{-2, 0, 3\}$, $\lambda = -3$. Знайти $A + B$ і $\lambda A$.
% \end{problem*}

% \begin{solution}
%     \begin{align*}
%         A + B &= \{(-5) + (-2), (-5) + 0, (-5) + 3, (-3) + (-2), (-3) + 0, \\
%         & \left.\right. \quad (-3) + 3, 2 + (-2), 2 + 0, 2 + 3\} = \{-7, -5, -2, -5, -3, 0, 0, 2, 5\} = \\
%         &= \{-7, -5, -3, -2, 0, 2, 5\}, \\
%         \lambda A &= \{(-3) \cdot (-5), (-3) \cdot (-3), (-3) \cdot 2\} = \{ 15, 9, -6 \}.
%     \end{align*}
% \end{solution}


% \begin{problem*}
%     $A = [-4, -3]$, $B = [-2, 6]$, $\lambda = 2$. Знайти $A + B$ і $\lambda A$.
% \end{problem*}

% \begin{solution}
%     $A + B = [(-4) + (-2), (-3) + 6] = [-6, 3]$, $\lambda A = [2\cdot(-4), 2\cdot(-3)] = [-8, -6]$.
% \end{solution}

% \begin{problem*}
%     $M = \begin{pmatrix} -2 & 1 \\ 3 & 7 \\ 0 & 4 \end{pmatrix}$, $A = \left\{ \begin{pmatrix} 1 \\ 0 \end{pmatrix}, \begin{pmatrix} -1 \\ 2 \end{pmatrix}, \begin{pmatrix} 3 \\ -2 \end{pmatrix} \right\}$. Знайти $MA$.
% \end{problem*}

% \begin{solution}
%     \begin{align*}
%         MA &= \left\{ \begin{pmatrix} -2 & 1 \\ 3 & 7 \\ 0 & 4 \end{pmatrix} \begin{pmatrix} 1 \\ 0 \end{pmatrix}, \begin{pmatrix} -2 & 1 \\ 3 & 7 \\ 0 & 4 \end{pmatrix} \begin{pmatrix} -1 \\ 2 \end{pmatrix}, \begin{pmatrix} -2 & 1 \\ 3 & 7 \\ 0 & 4 \end{pmatrix}  \begin{pmatrix} 3 \\ -2 \end{pmatrix} \right\} = \\
%         &= \left\{ \begin{pmatrix} -2 \\ 3 \\ 0 \end{pmatrix}, \begin{pmatrix} 4 \\ 11 \\ 8 \end{pmatrix}, \begin{pmatrix} -8 \\ -5 \\ -8 \end{pmatrix}\right\}.
%     \end{align*}
% \end{solution}

\begin{problem}
    % 2.7
\end{problem}

\begin{solution}
    % 2.7
\end{solution}

\begin{problem}
    % 2.8
\end{problem}

\begin{solution}
    % 2.8
\end{solution}


\begin{problem}
    Знайти опорні функції таких множин:
    \begin{enumerate}
        \item $A = \{ -1, 1 \}$;
        \item $A = \{ (x_1, x_2, x_3) : |x_1| \le 2, |x_2| \le  4, |x_3| \le 1 \}$;
        \item $A = \{ a \}$;
        \item $A = \KK_r(a) = \{ x\in \RR^n : \| x - a \| \le r \}$.
    \end{enumerate}
\end{problem}

\begin{solution}
    \begin{enumerate}
        \item За визначенням, $c(A, \psi) = \Max_{x \in \{-1, 1\}} \langle x, \psi\rangle = \max(-\psi,\psi) = |\psi|$.
        \item За визначенням, $c(A, \psi) = \Max_{\substack{ x_1 : |x_1| \le 2 \\ x_2 : |x_2| \le  4 \\ x_3 : |x_3| \le 1 }} x_1 \psi_1 + x_2 \psi_2 + x_3 \psi_3  = 2 |\psi_1| + 4 |\psi_2| + |\psi_3|$.
        \item За визначенням, $c(A, \psi) = \Max_{x \in \{ a \}} \langle x, \psi\rangle = \langle a, \psi\rangle $.
        \item За визначенням, 
        \begin{align*}
            c(A, \psi) &= \Max_{x \in \RR^n : \| x - a \| \le r} \langle x, \psi\rangle = \Max_{y \in \RR^n : \| y \| \le r} \langle a + y, \psi\rangle = \\
            &= \langle a, \psi\rangle + \Max_{y \in \RR^n : \| y \| \le r} \langle y, \psi\rangle = \langle a, \psi\rangle + c(\KK_r(0), \psi) = \langle a, \psi \rangle + r\|\psi\|.
        \end{align*}
    \end{enumerate}
\end{solution}

\begin{problem}
    Знайти інтеграл Аумана $\JJ = \int_0^{\pi/2} F(x) dx$ таких багатозначних відображень:
    \begin{enumerate}
        \item $F(x) = [0, \sin x]$, $x \in [0, \pi / 2]$.
        \item $F(x) = [-\sin x, \sin x]$, $x \in [0, \pi / 2]$.
        \item $F(x) = \KK_{\sin x}(0) = \{ y \in \RR^n : \| y \| \le \sin x \}$, $x \in [0, \pi / 2]$.
    \end{enumerate}
\end{problem}

\begin{solution}
    Скористаємося теоремою про зміну порядку інтегрування і взяття опорної функції:
    \begin{enumerate}
        \item $c(\JJ, \psi) = \int_0^{\pi/2} c([0, \sin x], \psi) dx = \int_0^{\pi/2} \max(0, \psi) \sin x dx = \max(0, \psi)$, звідки $\JJ = [0, 1]$.
        \item $c(\JJ, \psi) = \int_0^{\pi/2} c([-\sin x, \sin x], \psi) dx = \int_0^{\pi/2} |\psi| \sin x dx = |\psi|$, звідки $\JJ = [-1, 1]$.
        \item $c(\JJ, \psi) = \int_0^{\pi/2} c(\KK_{\sin x}(0), \psi) dx = \int_0^{\pi/2} \sin x \|\psi\| dx = \|\psi\|$, звідки $\JJ = \KK_1(0)$. 
    \end{enumerate}
\end{solution}

\begin{problem}
    Знайти множину досяжності такої системи керування:
    \[\frac{\diff x}{\diff t} = x + bu,\] 
    де $x(0) = x_0 \in \MM_0$, $u(t)\in \UU$, $t\ge0$, $b$ -- деяке ненульове число, 
    \[ \MM_0 = \{ x : | x | \le 2 \}, \]
    \[ \UU = \{ u : |u| \le 3 \}. \]
\end{problem}

\begin{solution}
    Множину досяжності знайдемо через її опорну функцію: 
    \[ c(\XX(t, \MM_0), \psi) = c(\MM_0, \Theta^*(t, t_0) \psi) + \int_{t_0}^t c(\UU(s), C^\star(s) \Theta^*(t, s)\psi) \diff s. \]
    Для цього послідовно знаходимо: \\
    
    $\Theta(t, s) = e^{t-s}$, знайдено із рівності $\dfrac{d\Theta(t,s)}{dt} = A(t)\Theta(t,s) = \Theta(t,s)$ у нашому випадку. \\
    
    $c(\MM_0, \psi) = c([-2, 2], \psi) = 2 |\psi|$, вже достатньо відома нам опорна функція. \\
    
    $c(\UU(s), \psi) = c([-3, 3], \psi) = 3 |\psi|$, ще одна вже достатньо відома нам опорна функція. \\
    
    % Послідовно пісдтавляючи знайдені вирази в формулу вище знаходимо:
    % \begin{equation*}
    % \begin{split}
    %     c(X(t, \MM_0), \psi) &= c(\MM_0, \Theta^\star(t, t_0), \psi) + \int_{t_0}^t c(\UU(s), C^\star(s) \Theta^\star(t, s)\psi) ds = \\
    %     &= c([-2,2], \Theta^\star(t, 0), \psi) + \int_0^t c([-3, 3], b \Theta^\star(t, s)\psi) ds = \\
    %     &= 2\left|\Theta^\star(t, 0)\psi\right| + \int_0^t 3\left|b \Theta^\star(t, s)\psi\right| ds = \\
    %     &= 2\left|e^{-t}\psi\right| + \int_0^t 3\left|b e^{s-t}\psi\right| ds = 2e^{-t}|\psi| + 3|b \psi| \int_0^t e^{s-t} ds = \\
    %     &= 2e^{-t}|\psi| + 3|b \psi| \left(1 - e^{-t}\right) = \left(2e^{-t} + 3|b|\left(1 - e^{-t}\right)\right) |\psi|,
    % \end{split}
    % \end{equation*}
    % звідки $X(t, \MM_0) = \left[-2e^{-t} - 3|b|\left(1 - e^{-t}\right), 2e^{-t} + 3|b|\left(1 - e^{-t}\right)\right]$.
    
    
    Послідовно пісдтавляючи знайдені вирази в формулу вище знаходимо:
    \begin{equation*}
    \begin{split}
        c(X(t, \MM_0), \psi) &= c(\MM_0, \Theta^\star(t, t_0), \psi) + \int_{t_0}^t c(\UU(s), C^\star(s) \Theta^\star(t, s)\psi) ds = \\
        &= c([-2,2], \Theta^\star(t, 0), \psi) + \int_0^t c([-3, 3], b \Theta^\star(t, s)\psi) ds = \\
        &= 2\left|\Theta^\star(t, 0)\psi\right| + \int_0^t 3\left|b \Theta^\star(t, s)\psi\right| ds = \\
        &= 2\left|e^t\psi\right| + \int_0^t 3\left|b e^{t-s}\psi\right| ds = 2e^t|\psi| + 3|b \psi| \int_0^t e^{t-s} ds = \\
        &= 2e^t|\psi| + 3|b \psi| \left(e^t - 1\right) = \left(2e^t + 3|b|\left(e^t - 1\right)\right) |\psi|,
    \end{split}
    \end{equation*}
    звідки $\XX(t, \MM_0) = \left[-2e^t - 3|b|\left(e^t - 1\right), 2e^t + 3|b|\left(e^t - 1\right)\right]$.
\end{solution}

\begin{problem}
Знайти опорну функцію множини досяжності для системи керування:
\begin{equation*}
    \left\{
    \begin{aligned}
    \dfrac{dx_1}{dt} &= x_1 - x_2 + 2u_1, \\
    \dfrac{dx_2}{dt} &= -4x_1 + x_2 + u_2,
    \end{aligned}
    \right.
\end{equation*}
де $x(0) = (x_{01}, x_{02}) \in \mathcal{M}_0$, $u(t) = (u_1(t), u_2(t)) \in\mathcal{U}$, $t\ge0$,
\begin{align*}
    \mathcal{M}_0 &= \{(x_{01},x_{02}): x_{01}^2 + x_{02}^2 \le 4\}, \\
    \mathcal{U} &= \{(u_1, u_2): u_1^2 + u_2^2 \le 1\}.
\end{align*}
\end{problem}

\begin{solution}
    Одразу помітимо, що $C=\begin{pmatrix}2&0\\0&1\end{pmatrix}$.\\

    $\Theta(t,s)$ знайдемо розв'язавши однорідну систему:
    \begin{equation*}
        \left\{
        \begin{aligned}
        \dfrac{dx_1}{dt} &= x_1 - x_2, \\
        \dfrac{dx_2}{dt} &= -4x_1 + x_2,
        \end{aligned}
        \right.
    \end{equation*}
    
    Її визначник $\begin{vmatrix} 1 - \lambda & - 1 \\ - 4 & 1 - \lambda \end{vmatrix} = (1 - \lambda)^2 - 4 = (\lambda + 1) (\lambda - 3) = 0$, звідки $\lambda_1 = -1$, $\lambda_2 = 3$. \\
    
    Підставляючи знайдені числа у систему, знаходимо власні вектори: $\begin{pmatrix} 1 \\ 2 \end{pmatrix}$ та $\begin{pmatrix} 1 \\ -2 \end{pmatrix}$ відповідно. \\

    Отже загальний розв'язок має вигляд \[\begin{pmatrix} x_1 \\ x_2 \end{pmatrix}(t) = c_1 \begin{pmatrix} e^{-t} \\ 2e^{-t} \end{pmatrix} + c_2 \begin{pmatrix} e^{3t} \\ -2e^{3t} \end{pmatrix}\]
    
    Розв'язуючи рівняння
    \[ c_1 \begin{pmatrix} e^{-s} \\ 2e^{-s} \end{pmatrix} + c_2 \begin{pmatrix} e^{3s} \\ -2e^{3s} \end{pmatrix} = \begin{pmatrix} 1 \\ 0 \end{pmatrix} \]
    і
    \[ c_1 \begin{pmatrix} e^{-s} \\ 2e^{-s} \end{pmatrix} + c_2 \begin{pmatrix} e^{3s} \\ -2e^{3s} \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}, \]
    знаходимо фундаментальну матрицю системи, нормовану за моментом $s$, а саме 
    \[ \Theta(t,s) = \begin{pmatrix} \dfrac{e^{s-t} + e^{3(t-s)}}{2} & \dfrac{e^{s-t} - e^{3(t-s)}}{4} \\ e^{s-t} - e^{3(t-s)} & \dfrac{e^{s-t} + e^{3(t-s)}}{2} \end{pmatrix} \]
    
    
    Далі знаходимо $c(\mathcal{M}_0, \psi) = c(\mathcal{K}_2(0), \psi) = 2\|\psi\|$, та $c(\mathcal{U}, \psi) = c(\mathcal{K}_1(0), \psi) = \|\psi\|$, вже достатньо відомі нам опорні функції. \\
    
    Нарешті, можемо зібрати це все докупи: 
    \begin{align*}
        c(\mathcal{X}(t, \mathcal{M}_0), \psi) &= c(\mathcal{M}_0, \Theta^\star(t, 0) \psi) + \int_{0}^t c(\mathcal{U}(s), C^\star(s) \Theta^\star(t, s)\psi) ds = \\
        \\
        &= 2 \|\Theta^\star(t, 0) \psi\| + \int_{0}^t \left\|C^\star(s) \Theta^\star(t, s)\psi\right\| ds = \\
        \\
        &= 2 \left\|\begin{pmatrix} \dfrac{e^{-t} + e^{3t}}{2} & e^{3t} - e^{-t} \\ \dfrac{e^{3t} - e^{-t}}{4} & \dfrac{e^{-t} + e^{3t}}{2} \end{pmatrix} \begin{pmatrix} \psi_1 \\ \psi_2 \end{pmatrix}\right\| + \\
        \\
        &+ \int_{0}^t \left\|\begin{pmatrix} e^{s-t} + e^{3(t-s)} & 2(e^{3(t-s)} - e^{s-t}) \\ \dfrac{e^{3(t-s)} - e^{s-t}}{4} & \dfrac{e^{s-t} + e^{3(t-s)}}{2} \end{pmatrix} \begin{pmatrix} \psi_1 \\ \psi_2 \end{pmatrix}\right\| ds = \\
        \\
        &= 2 \left\| \begin{pmatrix} \dfrac{e^{-t} + e^{3t}}{2} \cdot \psi_1 + (e^{3t} - e^{-t}) \cdot \psi_2 \\ \dfrac{e^{3t} - e^{-t}}{4}\cdot\psi_1 + \dfrac{e^{-t} + e^{3t}}{2}\cdot\psi_2 \end{pmatrix} \right\| + ...
    \end{align*}
\end{solution} 