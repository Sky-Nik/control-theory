\setcounter{section}{6}

\numberwithin{equation}{section}
\numberwithin{theorem}{section}
\numberwithin{example}{section}

\section{Принцип максимуму Понтрягіна для задачі з вільними правим кінцем}

\subsection{Лекція}

\subsubsection{Постановка задачі і формулювання принципу максимуму}

Розглянемо задачу Больца з вільним правим кінцем
\begin{equation}
    \label{eq:6.1}
    \mathcal{J}(u, x) = \Int_{t_0}^T f_0 (x(s), u(s), s) \, \dif s + \Phi(x(T))
\end{equation}
за умов
\begin{equation}
    \label{eq:6.2}
    \dot x = f(x, u, t), t \in [t_0, T],
\end{equation}
\begin{equation}
    \label{eq:6.3}
    x(t_0) = x_0.
\end{equation}
Тут $x = (x_1, x_2, \ldots, x_n)^*$ -- фазові координати, $u = (u_1, u_2, \ldots, u_m)^*$ -- кусково-неперервне керування таке. що $u(t) \in \mathcal{U}, t \in [t_0, T]$, де $\mathcal{U} \subseteq \RR^m$, не залежить від часу. \\

$f_0(x, u, t) \to \RR$, $f(x, u, t) \to \RR^n$ є неперервними за сукупністю змінних, разом зі своїми градієнтами за $x$, $\Phi(x)$ -- неперервно диференційовна, $(x, u, t) \in \RR^n \times \mathcal{U} \times [t_0, T]$, $x_0 \in \RR^n$. \\

За цих умов справджується теорема про існування та єдиність (кусково-гладкого) розв'язку задачі Коші для системи (\ref{eq:6.2}) для довільного керування. \\

Моменти часу $t_0$ і $T$ фіксовані, а обмеження на фазові координати відсутні. \\

Якщо існує оптимальне керування задачі (\ref{eq:6.1})-(\ref{eq:6.3}), тобто допустиме $u_* = u_*(\cdot)$ і відповідний йому розв'язок $x_* = x_*(\cdot)$ задачі Коші (\ref{eq:6.2})-(\ref{eq:6.3}) такі, що
\begin{equation*}
    \inf \mathcal{J}(u, x) = \mathcal{J}(u_*, x_*),
\end{equation*}
то будемо говорити про розв'язок задачі як про пару $(u_*(\cdot), x_*(\cdot))$. \\

Функція вигляду
\begin{equation}
    \label{eq:6.4}
    \mathcal{H}(x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle,
\end{equation}
де $\psi = (\psi_1, \psi_2, \ldots, \psi_n)^*$ -- нові, спряжені змінні, називається функцією Гамільтона-Понтрягіна. \\

Для кожної пари $(u(\cdot), x(\cdot))$, де $u(\cdot)$ -- допустиме керування, а $x(\cdot)$ -- відповідний йому розв'язок задачі Коші (\ref{eq:6.2})-(\ref{eq:6.3}), розглянемо систему звичайних диференціальних рівнянь
\begin{equation}
    \label{eq:6.5}
    \dot \psi = - \nabla_x \mathcal{H}(x, u, \psi, t), t \in [t_0, T],
\end{equation}
\begin{equation}
    \label{eq:6.6}
    \psi(T) = - \nabla \Phi(x(T)).
\end{equation}

Ця система називається спряженою системою, яка відповідає парі $(u(\cdot), x(\cdot))$. \\

\begin{theorem}[принцип максимуму Понтрягіна]
    Для розв'язку $(u_*(\cdot), x_*(\cdot))$ задачі Больца (\ref{eq:6.1}), (\ref{eq:6.3}) існує $\psi_*(\cdot)$ яка задовольняє спряженій системі яка відповідає парі $(u_*(\cdot), x_*(\cdot))$, причому майже для кожного $t \in [t_0, T]$ функція Гамільтона-Понтрягіна досягає свого максимуму при $u(t) = u_*(t)$, а саме
    \begin{equation*}
        \sup_{u \, \in \, \mathcal{U}} \mathcal{H}(x_*, u, \psi, t) = \mathcal{H}(x_*, u_*, \psi_*, t)
    \end{equation*}
\end{theorem}

\begin{example}
    Розглянемо задачу
    \[ \mathcal{J}(u) = \dfrac12 \Int_0^T u^2(s) \dif s + \dfrac{x^2(T)}{2} \]
    за умови
    \[ \dot x = a x + y, x(t_0) = x_0, \]
    де $x(\cdot): \RR \to \RR$, $u(\cdot): \RR \to \RR$, $a$ -- сталий параметр, $x_0$ -- фіксована точка. \\
    
    Функція Гамільтона-Понтрягіна має вигляд
    \[ \mathcal{H}(x, u, \psi, t) = - \dfrac{u^2}{2} + \psi (a x + u). \]
    
    Спряжена система записується так:
    \[ \dot \psi = - \nabla_x \mathcal{H} = - a \psi, \psi(T) = - x(T). \]
    
    Її розв'язок 
    \[ \psi(t) = - x(T) \cdot e^{a (T - t)}. \]
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування
    \[ \dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = 0.\]
    
    Звідси $- u_* + \psi = 0$ і $u_*(t) = \psi(t) = - x(T) \cdot e^{a (T - t)}$. \\
    
    Підставляємо знайдене керування у рівняння 
    \[ \dot x = a x + u, x(t_0) = x_0. \]
    
    Формула Коші для загального розв'язку лінійного рівняння першого порядку має вигляд
    \begin{equation*}
        \begin{aligned}
            x(t) &= e^{a t} x_0 + \Int_0^t e^{a (t - s)} \cdot u(s) \dif s = e^{a t} x_0 - \Int_0^t  e^{a (t - s)} \cdot x(T) \cdot e^{a (T - s)} \dif s = \\
            &= e^{a t} x_0 - e^{a t + a T} x(T) \Int_0^t  e^{- 2 a s} \dif s = e^{a t} x_0 - \dfrac{e^{a T} \cdot x(T) \cdot \left(e ^{at} - e^{-a t}\right)}{2a},
        \end{aligned}
    \end{equation*}
    
    звідки, при $t = T$:
    \[ x(T) = e^{aT} \left( x_0 - \dfrac{x(T) \cdot \left( e^{aT} - e^{-aT} \right)}{2a} \right), \]
    
    звідки
    \[ x(T) = \dfrac{e^{a T} x_0}{1 - \frac{e^{aT}}{2a} \cdot \left(e^{aT} - e^{-aT}\right)}. \]
    
    
    Підсумовуючи все вищесказане,
    \[ u_*(t) = - \dfrac{e^{a (2T - t)} x_0}{1 - \frac{e^{aT}}{2a} \cdot \left(e^{aT} - e^{-aT} \right)}, \]
    причому 
    \[ x_*(t) = e^{at} x_0 - \dfrac{e^{2 a T} x_0 \cdot \left( e^{at} - e^{-at} \right)}{2a - e^{2aT} - 1}. \]
    
\end{example}

\subsection{Аудиторне заняття}

\begin{problem}
    Записати крайову задачу принципу максимуму для задачі оптимального керування:
    \begin{equation*}
        \mathcal{J}(u) = \Int_0^T (u^2(s) + x_1^4(s)) \, \dif s + x_2^4(T) \to \inf
    \end{equation*}
    за умови, що
    \begin{system*}
        \dot x_1 &= \sin(x_1 - x_2) + u, \\
        \dot x_2 &= \cos(-4x_1 + x_2),
    \end{system*}
    \begin{equation*}
        x_1(0) = 1, x_2(0) = 2.
    \end{equation*}
    Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $u(t)$ -- функція керування, $t \in [0, T]$, момент часу $T$ є заданим.
\end{problem}

\begin{solution}
    Для початку випишемо всі функції з теоретичної частини:
    \begin{equation}
        f_0(x, u, t) = u^2(t) + x_1^4(t), \quad f(x(t), u(t), t) = \begin{pmatrix} \sin(x_1(t) - x_2(t)) + u(t) \\ \cos(-4x_1(t) + x_2(t)) \end{pmatrix}, \quad \Phi(x(T)) = x_2^4(T).
    \end{equation}

    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \begin{aligned}
        \mathcal{H} (x, u, \psi, t) &= - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = \\
        &= - u^2 - x_1^4 + \langle \psi, f(x, u, t) \rangle = \\
        &= - u^2 - x_1^4 + \left\langle \psi, \begin{pmatrix} \sin(x_1 - x_2) + u \\ \cos(-4x_1 + x_2) \end{pmatrix} \right\rangle = \\
        &= - u^2 - x_1^4 + \left\langle \begin{pmatrix} \psi_1 \\ \psi_2 \end{pmatrix}, \begin{pmatrix} \sin(x_1 - x_2) + u \\ \cos(-4x_1 + x_2) \end{pmatrix} \right\rangle = \\
        &= - u^2 - x_1^4 + \psi_1 \cdot \sin(x_1 - x_2) + \psi_1 \cdot u + \psi_2 \cdot \cos(-4x_1 + x_2).
        \end{aligned}
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation} 
        \dot \psi = - \nabla_x \mathcal{H} = \begin{pmatrix} 4 x_1^3 - \psi_1 \cdot \cos(x_1 - x_2) - 4 \psi_2 \cdot \sin(-4x_1 + x_2) \\ \psi_1 \cdot \cos(x_1 - x_2) + \psi_2 \cdot \sin(-4x_1 + x_2) \end{pmatrix},
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = \begin{pmatrix} 0 \\ - 4 x_2^3(T) \end{pmatrix}.
    \end{equation}
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування
    \begin{equation} 
        \dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = -2 u + \psi_1 = 0,
    \end{equation}
    звідки $u = \psi_1 / 2$. Підставляємо знайдене керування у початкову систему:
    \begin{system}
        \dot x_1 &= \sin(x_1 - x_2) + \psi_1 / 2, \\
        \dot x_2 &= \cos(-4x_1 + x_2),
    \end{system}
\end{solution}

\begin{problem}
    Записати крайову задачу принципу максимуму для задачі оптимального керування:
    \begin{equation*}
        \mathcal{J}(u) = \gamma^2 \Int_0^T x^2(s) \, \dif s \to \inf
    \end{equation*}
    за умови, що
    \begin{equation*}
        \dot x = u, \quad x(0) = x_0
    \end{equation*}
    Тут $x(t) \in \RR^1$, $u(t) \in \RR^1$,
    \begin{equation*}
        |u(t)|\le \rho,
    \end{equation*}
    $t \in [0, T]$. Точка $x_0 \in \RR^1$ і момент часу $T$ є заданими.
\end{problem}

\begin{solution}
    Для початку випишемо всі функції з теоретичної частини:
    \begin{equation}
        f_0(x, u, t) = \gamma^2 x^2(t), \quad f(x(t), u(t), t) = u(t), \quad \Phi(x(T)) = 0, \quad \mathcal{U} = \mathcal{U}(t) = [-\rho, \rho].
    \end{equation}
    
    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \mathcal{H} (x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = - \gamma^2 x^2 + \psi u.
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation} 
        \dot \psi = - \nabla_x \mathcal{H} = - 2 \gamma^2 x,
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = 0,
    \end{equation}
    % її розв'язок 
    % \begin{equation}
    %     \psi(t) = - 2 \gamma^2 x(t) t.
    % \end{equation}
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто
    \begin{equation} 
        u = \rho \cdot \signum \psi.
    \end{equation} 
    Підставляємо знайдене керування у початкову систему:
    \begin{equation}
        \dot x = \rho \cdot \signum \psi.
    \end{equation}
\end{solution}

\begin{problem}
    Розв'язати задачу оптимального керування за допомогою принципу максимуму Понтрягіна:
    \begin{equation*}
        \mathcal{J}(u) = \dfrac12 \Int_0^T u^2(s) \, \dif s + \dfrac{x^2(T)}{2} \to \inf
    \end{equation*}
    за умови, що
    \begin{equation*}
        \dot x = u, x(0) = x_0
    \end{equation*}
    Тут $x(t) \in \RR^1$, $u(t) \in \RR^1$, $t \in [0, T]$. Точка $x_0 \in \RR^1$ і момент часу $T$ є заданими.
\end{problem}

\begin{solution}
    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \mathcal{H} (x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = - \dfrac{u^2}{2} + \psi u.
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation} 
        \dot \psi = - \nabla_x \mathcal{H} = 0,
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = - x(T),
    \end{equation}
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування
    \begin{equation} 
        \dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = - u + \psi = 0,
    \end{equation}
    звідки $u = \psi$. Підставляємо знайдене керування у початкову систему:
    \begin{equation}
        \dot x = \psi.
    \end{equation}
    
    З рівнянь на $\psi$ знаходимо $\psi(t) = - x(T)$. \\
    
    Підставляючи це у рівняння на $x$ знаходимо $x(t) = x_0 - x(T) \cdot t$. \\
    
    Звідси, при $t = T$ маємо $x(T) = x_0 - T \cdot x(T)$, тобто $x(T) = \dfrac{x_0}{1 + T}$. \\
    
    Остаточно, $(u_*(t), x_*(t)) = \left(- \dfrac{x_0}{1 + T}, - \dfrac{x_0 \cdot t}{1 + T}\right)$.
    
\end{solution}

\begin{problem}
    Розв'язати задачу оптимального керування за допомогою принципу максимуму Понтрягіна:
    \begin{equation*}
        \mathcal{J}(u) = \dfrac 12 \Int_0^T (u_1^2(s) + u_2^2(s) \, \dif s + \dfrac{x_1^2(T)}{2} \to \inf
    \end{equation*}
    \begin{system*}
        \dot x_1 &= x_2 + u_1, \\
        \dot x_2 &= x_1 + u_2,
    \end{system*}
    \begin{equation*}
        x_1(0) = 1, x_2(0) = 1.
    \end{equation*}
    Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $u = (u_1, u_2)^* \in \RR^2$ -- вектор керування, $t \in [0, T]$, момент часу $T$ є заданим.
\end{problem}

\begin{solution}
    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \mathcal{H} (x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = - \dfrac{u_1^2 + u_2^2}{2} + \psi_1(x_2 + u_1) + \psi_2(x_1 + u_2).
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation} 
        \dot \psi = - \nabla_x \mathcal{H} = \begin{pmatrix} \psi_2 \\ \psi_1 \end{pmatrix},
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = \begin{pmatrix} x_1(T) \\ 0 \end{pmatrix}.
    \end{equation}
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування
    \begin{equation} 
        \dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = \begin{pmatrix} - u_1 + \psi_1 \\ -u_2 + \psi_2 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix},
    \end{equation}
    звідки $u_1 = \psi_1$, $u_2 = \psi_2$. Підставляємо знайдене керування у початкову систему:
    \begin{system}
        \dot x_1 &= x_2 + \psi_1, \\
        \dot x_2 &= x_1 + \psi_2, \\
        \dot \psi_1 &= - \psi_2, \\
        \dot \psi_2 &= - \psi_1.
    \end{system}
    
    Розв'язуємо систему на $\psi_1$ і $\psi_2$:
    \begin{equation}
        \begin{pmatrix} \psi_1 \\ \psi_2 \end{pmatrix} = c_1 \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^t + c_2 \begin{pmatrix} 1 \\ 1 \end{pmatrix} e^{-t}.
    \end{equation}
    
    Підставляємо це у систему на $x_1$, $x_2$:
    \begin{system}
        \dot x_1 &= x_2 + c_1 e^t + c_2 e^{-t}, \\
        \dot x_2 &= x_1 - c_1 e^t + c_2 e^{-t}.
    \end{system}
    
    Знаходимо загальний розв'язок однорідної системи:
    \begin{equation}
        \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = c_3 \begin{pmatrix} 1 \\ 1 \end{pmatrix} e^t + c_4 \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^{-t}.
    \end{equation}
    
    Шукаємо тепер частинний розв'язок неоднорідної системи методом невизначених коефіцієнтів у вигляді:
    \begin{equation}
        \begin{pmatrix} x_1(t) \\ x_2(t) \end{pmatrix} = \begin{pmatrix} e^t (A_{11} t + B_{11}) + e^{-t} (A_{12} t + B_{12}) \\ e^t (A_{21} t + B_{21}) + e^{-t} (A_{22} t + B_{22})  \end{pmatrix}
    \end{equation}
    Підставляючи це у системи, знаходимо
    \begin{system}
        A_{11} &= A_{21}, \\
        B_{11} + A_{11} &= B_{21} - c_1, \\
        -A_{12} &= A_{22}, \\
        - B_{12} + A_{12} &= B_{22} + c_2, \\
        A_{21} &= A_{11}, \\
        B_{21} + A_{21} &= B_{11} + c_1, \\
        -A_{22} &= A_{12}, \\
        - B_{22} + A_{22} &= B_{12} + c_2.
    \end{system}
    
    Беремо розв'язок $A_{11} = A_{12} = A_{21} = A_{22} = 0$, $B_{11} = B_{12} = 0$, $B_{21} = c_1$, $B_{22} = c_2$, тоді
    \begin{equation}
        \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = c_3 \begin{pmatrix} 1 \\ 1 \end{pmatrix} e^t + c_4 \begin{pmatrix} 1 \\ -1 \end{pmatrix} e^{-t} + \begin{pmatrix} - c_2 e^{-t} \\ c_1 e^t \end{pmatrix}.
    \end{equation}
    Пригадаємо, що $x_1(0) = x_2(0) = 1$, це дає систему
    \begin{system}
        c_3 + c_4 - c_2 &= 1, \\
        c_3 - c_4 + c_1 &= 1,
    \end{system}

    з якої $c_3 = 1 - \dfrac{c_1}{2} + \dfrac{c_2}{2}$, $c_4 = \dfrac{c_1}{2} + \dfrac{c_2}{2}$. \\
    
    І далі це якось (як ??) розв'язується.
\end{solution}

% \begin{problem}

% \end{problem}

% \begin{problem}

% \end{problem}

\subsection{Домашнє завдання}

\setcounter{problem}{6}

\begin{problem}
    Записати крайову задачу принципу максимуму для задачі оптимального керування:
    \begin{equation*}
        \mathcal{J}(u) = \Int_0^T (4 u_1^2(s) + u_2^2(s) + \cos^2(x_1(s))) \, \dif s + \sin^2(x_2(T)) \to \inf
    \end{equation*}
    за умови, що
    \begin{system*}
        \dot x_1 &= x_1 + x_2 + 3 x_1 x_2 + 2 u_1, \\
        \dot x_2 &= - x_1 + 6 x_2 - 3 x_1 x_2 + u_2,
    \end{system*}
    \begin{equation*}
        x_1(0) = 4, x_2(0) = -2.
    \end{equation*}
    Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $u_1(t), u_2(t)$ -- функції керування, $t \in [0, T]$, момент часу $T$ є заданим.
\end{problem}

\begin{solution}
    Для початку випишемо всі функції з теоретичної частини:
    \begin{equation}
        \begin{aligned}
            f_0(x, u, t) &=  4 u_1^2(s) + u_2^2(s) + \cos^2(x_1(s)), \\
            f(x(t), u(t), t) &= \begin{pmatrix} x_1 + x_2 + 3 x_1 x_2 + 2 u_1 \\ - x_1 + 6 x_2 - 3 x_1 x_2 + u_2 \end{pmatrix}, \\
            \Phi(x(T)) &= \sin^2(x_2(T)).
        \end{aligned}
    \end{equation}

    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \begin{aligned}
        \mathcal{H} (x, u, \psi, t) &= - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = \\
        &= - 4 u_1^2(t) - u_2^2(t) - \cos^2(x_1(t)) + \langle \psi, f(x, u, t) \rangle = \\
        &= - 4 u_1^2(t) - u_2^2(t) - \cos^2(x_1(t)) + \left \langle \psi, \begin{pmatrix} x_1 + x_2 + 3 x_1 x_2 + 2 u_1 \\ - x_1 + 6 x_2 - 3 x_1 x_2 + u_2 \end{pmatrix} \right \rangle = \\
        &= - 4 u_1^2(t) - u_2^2(t) - \cos^2(x_1(t)) + \left \langle \begin{pmatrix} \psi_1 \\ \psi_2 \end{pmatrix}, \begin{pmatrix} x_1 + x_2 + 3 x_1 x_2 + 2 u_1 \\ - x_1 + 6 x_2 - 3 x_1 x_2 + u_2 \end{pmatrix} \right \rangle = \\
        &= - 4 u_1^2(t) - u_2^2(t) - \cos^2(x_1(t)) + \psi_1 ( x_1 + x_2 + 3 x_1 x_2 + 2 u_1 ) + \psi_2 ( - x_1 + 6 x_2 - 3 x_1 x_2 + u_2 ).
        \end{aligned}
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation} 
        \dot \psi = - \nabla_x \mathcal{H} = \begin{pmatrix} \sin (2 x_1) + \psi_1 + 3 \psi_1 x_2 - \psi_2 - 3 \psi_2 x_2 \\ \psi_1 + 3 \psi_1 x_1 + 6 \psi_2 - 3 \psi_2 x_1 \end{pmatrix},
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = \begin{pmatrix} 0 \\ \sin (2 x_2) \end{pmatrix}.
    \end{equation} 
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування
    \begin{equation} 
        \dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = \begin{pmatrix} - 8 u_1 + 2 \psi_1 \\ - 2 u_2 + \psi_2 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix},
    \end{equation}
    звідки $u_1 = \psi_1 / 4$, $u_2 = \psi_2 / 2$. Підставляємо знайдене керування у початкову систему:
    \begin{system}
        \dot x_1 &= x_1 + x_2 + 3 x_1 x_2 + \psi_1 / 2, \\
        \dot x_2 &= - x_1 + 6 x_2 - 3 x_1 x_2 + \psi_2 / 2.
    \end{system}
\end{solution}

\begin{problem}
    Записати крайову задачу принципу максимуму для задачі оптимального керування:
    \begin{equation*}
        \mathcal{J}(u) = \gamma^2 \Int_0^T (x(s) - z(s))^2 \, \dif s \to \inf
    \end{equation*}
    за умови, що
    \begin{equation*}
        \dot x = u, x(0) = x_0.
    \end{equation*}
    Тут $x(t) \in \RR^1$, $u(t) \in \RR^1$,
    \begin{equation*}
        |u(t)| \le \rho,
    \end{equation*}
    $t \in [0, T]$. Точка $x_0 \in \RR^1$, неперервна функція $z(t) \in \RR^1$ і момент часу $T$ є заданими.
\end{problem}

\begin{solution}
    Для початку випишемо всі функції з теоретичної частини:
    \begin{equation}
        f_0(x, u, t) = \gamma^2 (x - z)^2, \quad f(x(t), u(t), t) = u(t), \quad \Phi(x(T)) = 0, \quad \mathcal{U} = \mathcal{U}(t) = [-\rho, \rho].
    \end{equation}
    
    Функція Гамільтона-Понтрягіна має вигляд
    \begin{equation}
        \mathcal{H} (x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = - \gamma^2 (x - z)^2 + \psi u.
    \end{equation}
    
    Спряжена система записується так:
    \begin{equation}
        \dot \psi = - \nabla_x \mathcal{H} = - 2 \gamma^2 x + 2 \gamma^2 z,
    \end{equation}
    \begin{equation} 
        \psi(T) = - \nabla \Phi(x(T)) = 0,
    \end{equation}
    % її розв'язок 
    % \begin{equation}
    %     \psi (t) = 2 \gamma^2 (z(t) - x(t)) t,
    % \end{equation}
    % причому, з крайової умови,
    % \begin{equation}
    %     x(T) = z(T).
    % \end{equation}
    
    Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто
    \begin{equation} 
        u = \rho \cdot \signum \psi.
    \end{equation} 
    Підставляємо знайдене керування у початкову систему:
    \begin{equation}
        \dot x = \rho \cdot \signum \psi.
    \end{equation}
\end{solution}

\begin{problem}
    Розв'язати задачу оптимального керування за допомогою принципу максимуму Понтрягіна:
    \begin{equation*}
        \mathcal{J}(u) = \dfrac12 \Int_0^T u^2(s) \, \dif s + \dfrac{(x(T) - x_1)^2}{2} \to \inf
    \end{equation*}
    за умови, що
    \begin{equation*}
        \dot x = a x + u, x(0) = x_0.
    \end{equation*}
    Тут $x(t) \in \RR^1$, $u(t) \in \RR^1$, $t \in [0, T]$. Точки $x_0 \in \RR^1$, $x_1 \in \RR^1$ і момент часу $T$ є заданими.
\end{problem}

\begin{solution}
	Для початку випишемо всі функції з теоретичної частини:
	\begin{equation}
		f_0(x, u, t) = \dfrac{u^2}{2}, \quad f(x(t), u(t), t) = a x(t) + u(t), \quad \Phi(x(T)) = \dfrac{(x(T) - x_1)^2}{2}.
	\end{equation}

	Функція Гамільтона-Понтрягіна має вигляд:
	\begin{equation}
		\mathcal{H}(x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = - \dfrac{u^2}{2} + a \psi x + \psi u.
	\end{equation}

	Спряжена система записується так:
	\begin{equation}
		\dot \psi = - \nabla_x \mathcal{H} = - a \psi,
	\end{equation}
	\begin{equation}
		\psi(T) = - \nabla \Phi(x(T)) = x(T) - x_1.
	\end{equation}

	Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування,
	\begin{equation}
		\dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = - u + \psi = 0,
	\end{equation}
	звідки $u = \psi$. Підставляємо знайдене керування у початкову систему:
	\begin{system}
		\dot x &= a x + \psi, \\
		x(0) &= x_0, \\
		\dot \psi &= - a \psi, \\
		\psi(T) &= x(T) - x_1.
	\end{system}

	З рівнянь на $\psi$ знаходимо, що $\psi(t) = C_1 \cdot e^{-a t}$, де $C_1$ визначається з рівності $\psi(T) = x(T) - x_1$, тобто $C_1 = (x(T) - x_1) \cdot e^{a T}$. \\

	Підставляючи це у рівняння на $x$ знаходимо, що 
	\begin{equation}
		x(t) = C_2 e^{a t} - \dfrac{C_1 e^{-a t}}{2 a} = C_2 e^{a t} - \dfrac{(x(T) - x_1) \cdot e^{a (T - t)}}{2 a},
	\end{equation}
	де $C_2$ визначається з рівності $x(0) = x_0$, тобто $C_2 = x_0 + \dfrac{(x(T) - x_1) \cdot e^{a T}}{2 a}$. \\

	% x(t) = x_0 e^{a t} + \dfrac{(x(T) - x_1) \cdot (e^{a (T + t)} - e^{a (T - t)})}{2 a},

	Залишається знайти $x(T)$ з рівності 
	\begin{equation}
		x(T) = x_0 e^{a T} + \dfrac{(x(T) - x_1) \cdot (e^{2 a T} - 1)}{2 a}.
	\end{equation}
	Зробивши це, отримаємо
	\begin{equation}
		x(T) = \dfrac{x_1 (e^{2 a T} - 1) - 2 a x_0 e^{a T}}{e^{2 a T} - 2 a - 1}.
	\end{equation}

	Остаточно,
	\begin{equation}
		x(t) = x_0 e^{a t} + \dfrac{\left(\dfrac{x_1 (e^{2 a T} - 1) - 2 a x_0 e^{a T}}{e^{2 a T} - 2 a - 1} - x_1\right) \cdot \left(e^{a (T + t)} - e^{a (T - t)}\right)}{2 a},
	\end{equation}	
	\begin{equation}
		u(t) = \left(\dfrac{x_1 (e^{2 a T} - 1) - 2 a x_0 e^{a T}}{e^{2 a T} - 2 a - 1} - x_1\right) \cdot e^{a (T - t)}.
	\end{equation}
\end{solution}

\begin{problem}
    Записати крайову задачу принципу максимуму для задачі оптимального керування:
    \begin{equation*}
        \mathcal{J}(u) = \dfrac12 \Int_0^T (u^2(s) + x^2(s)) \, \dif s + \dfrac{(\dot x(T) - x_1)^2}{2} \to \inf
    \end{equation*}
    за умови, що
    \begin{equation*}
        \ddot x = u, x(0) = x_0, \dot x(0) = y_0.
    \end{equation*}
    Тут $x(t) \in \RR^1$, $u(t) \in \RR^1$, $t \in [0, T]$. Точки $x_0 \in \RR^1$, $y_0 \in \RR^1$ і момент часу $T$ є заданими.
\end{problem}

\begin{solution}
	Позначимо $\textbf{x} = \begin{pmatrix} \textbf{x}_1 & \textbf{x}_2 \end{pmatrix}^* = \begin{pmatrix} x & \dot x \end{pmatrix}^*$. \\

	Для початку випишемо всі функції з теоретичної частини:
	\begin{equation}
		f_0(\textbf{x}, u, t) = \dfrac{u^2 + \textbf{x}_1^2}{2}, \quad f(\textbf{x}(t), u(t), t) = \begin{pmatrix} \textbf{x}_1(t) \\ u(t) \end{pmatrix}, \quad \Phi(\textbf{x}(T)) = \dfrac{(\textbf{x}_2(T) - x_1)^2}{2}.
	\end{equation}

	Функція Гамільтона-Понтрягіна має вигляд:
	\begin{equation}
		\mathcal{H}(\textbf{x}, u, \psi, t) = - f_0(\textbf{x}, u, t) + \langle \psi, f(\textbf{x}, u, t) \rangle = - \dfrac{u^2 + \textbf{x}_1^2}{2} + \psi_1 \textbf{x}_1 + \psi_2 u.
	\end{equation}

	Спряжена система записується так:
	\begin{equation}
		\dot \psi = - \nabla_\textbf{x} \mathcal{H} = \begin{pmatrix} \textbf{x}_1 - \psi_1 \\ 0 \end{pmatrix}.
	\end{equation}
	\begin{equation}
		\psi(T) = - \nabla \Phi(\textbf{x}(T)) = \begin{pmatrix} 0 \\ \textbf{x}_2(T) - x_1 \end{pmatrix}.
	\end{equation}

	Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування,
	\begin{equation}
    	\dfrac{\partial \mathcal{H}(\textbf{x}, u, \psi, t)}{\partial u} = - u + \psi_2
	\end{equation}
	звідки $u = \psi_2$. Підставляємо знайдене керування у початкову систему:
	\begin{system}
	    \dot{\textbf{x}}_1 &= \textbf{x}_2. \\
	    \dot{\textbf{x}}_2 &= \psi_2.
	\end{system}
\end{solution}

\begin{problem}
    Розв'язати задачу оптимального керування за допомогою принципу максимуму Понтрягіна:
    \begin{equation*}
        \mathcal{J}(u) = \dfrac 12 \Int_0^T u^2(s) \, \dif s + x_2^2(T) \to \inf
    \end{equation*}
    \begin{system*}
        \dot x_1 &= x_1 - x_2 + u, \\
        \dot x_2 &= - 4 x_1 + x_2,
    \end{system*}
    \begin{equation*}
        x_1(0) = 2, x_2(0) = 4.
    \end{equation*}
    Тут $x = (x_1, x_2)^*$ -- вектор фазових координат з $\RR^2$, $u(t)$ -- функція керування, $t \in [0, T]$, момент часу $T$ є заданим.
\end{problem}

\begin{solution}
    Для початку випишемо всі функції з теоретичної частини:
	\begin{equation}
		f_0(x, u, t) = \dfrac{u^2}{2}, \quad f(x(t), u(t), t) = \begin{pmatrix} x_1(t) - x_2(t) + u(t) \\ -4x_1(t) + x_2(t) \end{pmatrix}, \quad \Phi(x(T)) = x_2(T))^2.
	\end{equation}
	
	Функція Гамільтона-Понтрягіна має вигляд:
	\begin{equation}
		\mathcal{H}(x, u, \psi, t) = - f_0(x, u, t) + \langle \psi, f(x, u, t) \rangle = -\dfrac{u^2}{2} + \psi_1 x_1 - \psi_1 x_2 + \psi_1 u - 4 \psi_2 x_1 + \psi_2 x_2.
	\end{equation}

	Спряжена система записується так:
	\begin{equation}
		\dot \psi = - \nabla_x \mathcal{H} = \begin{pmatrix} - \psi_1 + 4 \psi_2 \\ \psi_1 - \psi_2 \end{pmatrix},
	\end{equation}
	\begin{equation}
		\psi(T) = - \nabla \Phi(x(T)) = 2 x_2(T).
	\end{equation}

	Згідно принципу максимуму, функція Гамільтона-Понтрягіна на оптимальному керуванні досягає свого максимуму, тобто, за відсутності обмежень на керування,
	\begin{equation}
		\dfrac{\partial \mathcal{H}(x, u, \psi, t)}{\partial u} = - u + \psi_1 = 0,
	\end{equation}
	звідки $u = \psi_1$. Підставляємо знайдене керування у початкову систему:
	\begin{system}
		\dot x_1 &= x_1 - x_2 + \psi_1, \\
		\dot x_2 &= - 4 x_1 + x_2.
	\end{system}

 	З рівнянь на $\psi$ знаходимо
 	\begin{equation}
 	    \psi = C_1 \begin{pmatrix} 2 \\ -1 \end{pmatrix} e^{-3t} + C_2 \begin{pmatrix} 2 \\ 1 \end{pmatrix} e^{t},
 	\end{equation}
 	де $C_1$ і $C_2$ визначаються з крайових умов. \\

	Підставляючи це у рівняння на $x$ знаходимо, що 
    \begin{system}
        \dot x_1 &= x_1 - x_2 + 2 C_1 e^{-3t} + 2 C_2 e^{t}, \\
		\dot x_2 &= - 4 x_1 + x_2.
    \end{system}
    
    Загальний розв'язок однорідного рівняння має вигляд 
    \begin{equation}
        x = C_3 \begin{pmatrix} 1 \\ 2 \end{pmatrix} e^{-t} + C_4 \begin{pmatrix} 1 \\ -2 \end{pmatrix} e^{3t}.
    \end{equation}
    
    Частинний розв'язок неоднорідного знайдемо методом невизначених коефіцієнтів. Покладемо
    \begin{equation}
        x = \begin{pmatrix} A_1 \\ A_2 \end{pmatrix} e^{-3t} + \begin{pmatrix} B_{11} \\ B_{21} \end{pmatrix} e^{t} + \begin{pmatrix} B_{12} \\ B_{22} \end{pmatrix} x e^{t},
    \end{equation}
    тоді, при підстановці у систему, отримаємо:
    \begin{system}
        - 3 A_1 e^{-3 t} + B_1 e^t &= A_1 e^{-3 t} + B_1 e^t - A_2 e^{-3 t} - B_2 e^t + 2 C_1 e^{-3t} + 2 C_2 e^{t}, \\
		- 3 A_2 e^{-3 t} + B_2 e^t &= - 4 A_1 e^{-3 t} - 4 B_1 e^t + A_2 e^{-3 t} + B_2 e^t.
    \end{system}
    Ця система рівносильна системі
    \begin{system}
        - 3 A_1 &= A_1 - A_2 + 2 C_1, \\
        B_1 &= B_1 - B_2 + 2 C_2, \\
		- 3 A_2 &= - 4 A_1 + A_2, \\
		B_2 &= - 4 B_1 + B_2. \\
    \end{system}
\end{solution}

% \begin{problem}

% \end{problem}